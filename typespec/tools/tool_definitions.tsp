import "./base.tsp";
import "./functions.tsp";
import "./integrations.tsp";
import "./system.tsp";
import "./api_call.tsp";
import "./anthropic.tsp";

using Tools;

namespace Tools;

// AIDEV-NOTE: Core tool models consolidated here.

model Tool {
    /** Name of the tool (must be unique for this agent and a valid python identifier string )*/
    name: validPythonIdentifier;

    /** Type of the tool */
    type: ToolType;

    /** Description of the tool */
    description?: string;

    /** The function to call */
    function?: FunctionDef;

    /** The integration to call */
    integration?: IntegrationDef;

    /** The system to call */
    system?: SystemDef;

    /** The API call to make */
    api_call?: ApiCallDef;

    /** (Alpha) Anthropic new tools */
    computer_20241022?: Computer20241022Def;
    text_editor_20241022?: TextEditor20241022Def;
    bash_20241022?: Bash20241022Def;

    ...HasTimestamps;
    ...HasId;
}

model ToolResponse {
    @key id: string;

    /** The output of the tool */
    output: ToolOutput;
}

/** Payload for creating a tool */
@withVisibility("create")
model CreateToolRequest {
    ...Tool;
}

/** Payload for updating a tool */
@withVisibility("update")
model UpdateToolRequest {
    ...Tool;
}

/** Payload for patching a tool */
model PatchToolRequest is UpdateToolRequest {}

/** The response tool value generated by the model */
model BaseChosenToolCall {
    /** Whether this tool is a `function`, `api_call`, `system` etc. (Only `function` tool supported right now) */
    type: ToolType;

    function?: FunctionCallOption;
    integration?: unknown; // ChosenIntegrationCall
    system?: unknown; // ChosenSystemCall
    api_call?: unknown; // ChosenApiCall

    /** (Alpha) Anthropic new tools */
    computer_20241022?: ChosenComputer20241022;
    text_editor_20241022?: ChosenTextEditor20241022;
    bash_20241022?: ChosenBash20241022;

    @visibility("read")
    id?: string;
}

model ChosenFunctionCall extends BaseChosenToolCall {
    type: ToolType.function;

    /** The function to call */
    function: FunctionCallOption;
}

alias ChosenToolCall = (
    | ChosenFunctionCall
    // | ChosenIntegrationCall
    // | ChosenSystemCall
    // | ChosenApiCall
    | ChosenComputer20241022
    | ChosenTextEditor20241022
    | ChosenBash20241022
);
